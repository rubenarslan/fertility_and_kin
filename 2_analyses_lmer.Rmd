---
title: "2_analyses"
author: "Julie"
date: "14 November 2018"
output: html_document
---

# Analyses Alltag & Sex {.tabset}

Pre-registered hypothesis: 
a. Single women spend less time with male biological relatives during the FP (for paired women, we did not include questions about relative sex at this level of detail for reasons of length, but we would not make a different prediction).
b. All women spend less time with relatives during the FP (this question was asked for all participating women).


```{r echo=F, results='hide',message=F,warning=F}
source("0_helpers.R")
library(knitr) # um diese dokumente zu generieren
library(formr) # formr paket, kann daten laden
opts_chunk$set(warning = F, message = F, fig.width = 10, fig.height = 10)
library(lubridate) # mit datum-uhrzeit rechnen
library(pander) # schoen formatierte tabellen
library(ggplot2)
library(tidyr) # daten von lang nach breit und zurueck
library(dplyr) # daten zusammenfassen etc. immer als letztes laden
library(lme4)
library(lmerTest)
library(effects)
library(apaTables)
load("cleaned_selected.rdata")
diary$premenstrual_phase_fab = factor(diary$premenstrual_phase_fab)
diary$hormonal_contraception = factor(diary$hormonal_contraception)
diary_social$premenstrual_phase_fab = factor(diary_social$premenstrual_phase_fab)
diary_social$hormonal_contraception = factor(diary_social$hormonal_contraception)
# diary = diary %>% filter(answered_honestly_today == 1)
# diary_social = diary_social %>% filter(answered_honestly_today == 1)

diary = diary %>% mutate(
  social_life_active_numeric = as.numeric(social_life_active),
  purposefully_met_people = if_else(social_life_active_numeric < 4, 0, 1),
  menstruation_labelled = relevel(menstruation_labelled, "no")
)

diary_social = diary_social %>% mutate(
  menstruation_labelled = relevel(menstruation_labelled, "no")
)

# diary %>% filter(included_d == T) %>% View()
# rmarkdown::render("2_analyses.Rmd", word_document())

```

## 2: Women spend less time with relatives during FP compared to rest of cycle. {.tabset}

### multilevel models
#### time family (singles)
```{r}
model2_family <- lmer(time_family ~ premenstrual_phase_fab + menstruation_labelled + hormonal_contraception * fertile_fab + (1 | short ), data=diary %>% filter(included_d== T & abode_flat_share != 2 & relationship_status == 1))

model2_family <- lmer(time_family ~ premenstrual_phase_fab + menstruation_labelled + hormonal_contraception * prc_stirn_b_LH + (1 | short ), data=diary %>% filter(included_d== T & abode_flat_share != 2 & relationship_status == 1))

summary(model2_family)
plot(allEffects(model2_family, xlevels = 10))

plot_2way(model2_family)

tidy(model2_family) %>% select(term, estimate, p.value, conf.low, conf.high) %>% mutate(p.value = pvalues(p.value))

```

#### time family (whole sample)
```{r}
model2_family <- lmer(time_family ~ premenstrual_phase_fab + menstruation_labelled + hormonal_contraception * fertile_fab + (1 | short ), data=diary %>% filter(included_d== T & abode_flat_share != 2))

summary(model2_family)
plot(allEffects(model2_family, xlevels = 10))

plot_2way(model2_family)

tidy(model2_family) %>% select(term, estimate, p.value, conf.low, conf.high) %>% mutate(p.value = pvalues(p.value))

```

#### contact with relatives
```{r}
model2_relatives <- lmer (person_is_related_man ~ premenstrual_phase_fab + menstruation_labelled + hormonal_contraception * fertile_fab + (1 | short / created_diary ), data=diary_social %>% filter(included_s == T  & abode_flat_share !=2))

summary(model2_relatives)
plot(allEffects(model2_relatives))
plot_2way(model2_relatives)


tidy(model2_relatives) %>% select(term, estimate, p.value, conf.low, conf.high) %>% mutate(p.value = pvalues(p.value))

``` 

#### contact with relatives (hormonal data)
```{r}
model2_relatives <- lmer (person_is_related_man ~ premenstrual_phase_fab + menstruation_labelled + hormonal_contraception * prc_stirn_b_LH  + (1 | short / created_diary ), data=diary_social %>% filter(included_s == T  & abode_flat_share !=2))

summary(model2_relatives)
plot(allEffects(model2_relatives))
plot_2way(model2_relatives)


tidy(model2_relatives) %>% select(term, estimate, p.value, conf.low, conf.high) %>% mutate(p.value = pvalues(p.value))

``` 

#### contact with relatives (glmer)
```{r}
model2_relatives <- glmer (person_is_related_man ~ hormonal_contraception * fertile_fab + (1 | short / created_diary ), data=diary_social %>% filter(included_s == T  & abode_flat_share !=2), family = "binomial")

### konvergiert nur, wenn ich menstruation_labelled und premenstrual_phase_fab nicht mit aufnehme 

summary(model2_relatives)
plot(allEffects(model2_relatives))
plot_2way(model2_relatives)


tidy(model2_relatives) %>% select(term, estimate, p.value, conf.low, conf.high) %>% mutate(p.value = pvalues(p.value))

``` 

#### related men inferred
```{r}

model2_related_men_inferred <- lmer(person_is_related_man_inferred ~ premenstrual_phase_fab + menstruation_labelled + hormonal_contraception * fertile_fab + (1 | short / created_diary ), data=diary_social)

diary_social$person_is_related_inferred
diary_social$person_is_relate

nrow(diary_social)
summary(model2_related_men_inferred)


plot(allEffects(model2_related_men_inferred))
plot_2way(model2_related_men_inferred)

tidy(model2_related_men_inferred) %>% select(term, estimate, p.value, conf.low, conf.high) %>% mutate(p.value = pvalues(p.value))
```




#### relatives seen
```{r}

model2_relatives_seen <- lmer (person_is_related_man ~ premenstrual_phase_fab + menstruation_labelled + hormonal_contraception * prc_stirn_b_LH + (1 | short / created_diary ), data=diary_social %>% filter(included_s == T & person_seen == T & abode_flat_share !=2))
summary(model2_relatives_seen)
plot(allEffects(model2_relatives_seen))

plot_2way(model2_relatives_seen)

tidy(model2_relatives_seen) %>% select(term, estimate, p.value, conf.low, conf.high) %>% mutate(p.value = pvalues(p.value))
```
#### relatives seen (glmer)
```{r}

model2_relatives_seen <- glmer(person_is_related_man ~ menstruation_labelled + premenstrual_phase_fab  + hormonal_contraception * fertile_fab + (1 | short / created_diary ), data=diary_social %>% filter(included_s == T & person_seen == T & abode_flat_share !=2), family="binomial")

summary(model2_relatives_seen)
plot(allEffects(model2_relatives_seen))

plot_2way(model2_relatives_seen)

tidy(model2_relatives_seen) %>% select(term, estimate, p.value, conf.low, conf.high) %>% mutate(p.value = pvalues(p.value))
```

#### 2b relatives thought about 
```{r}
nrow(diary_social %>% filter(person_thought_about == T & included_s == T & abode_flat_share != 2 & person_is_related_man == T))

model2_social_life_related_thought_about <- lmer (person_is_related_man ~ premenstrual_phase_fab + menstruation_labelled + hormonal_contraception * fertile_fab + (1 | short / created_diary ), data=diary_social %>% filter(abode_flat_share !=2 & included_s == T & person_thought_about == T))
summary(model2_social_life_related_thought_about)
plot(allEffects(model2_social_life_related_thought_about))
plot_2way(model2_social_life_related_thought_about)

tidy(model2_social_life_related_thought_about) %>% select(term, estimate, p.value, conf.low, conf.high) %>% mutate(p.value = pvalues(p.value))

```
#### 2b relatives thought about (glmer)
```{r}
nrow(diary_social %>% filter(person_thought_about == T & included_s == T & abode_flat_share != 2 & person_is_related_man == T))

model2_social_life_related_thought_about <- glmer(person_is_related_man ~ menstruation_labelled + hormonal_contraception * fertile_fab + (1 | short / created_diary ), data=diary_social %>% filter(abode_flat_share !=2 & included_s == T & person_thought_about == T), family="binomial")
summary(model2_social_life_related_thought_about)
plot(allEffects(model2_social_life_related_thought_about))
plot_2way(model2_social_life_related_thought_about)

tidy(model2_social_life_related_thought_about) %>% select(term, estimate, p.value, conf.low, conf.high) %>% mutate(p.value = pvalues(p.value))
```


### brms

#### time family 
```{r}
library(brms)

m_tf = brm(time_family ~ menstruation_labelled + premenstrual_phase_fab + s(fertile_fab, by = hormonal_contraception) + ( 1 | short), data = diary %>% filter(included_d== T & abode_flat_share != 2 & relationship_status == 1))


summary(m_tf)


m_tf_2 = brm(time_family ~ menstruation_labelled + premenstrual_phase_fab + fertile_fab + s(fertile_fab, by = hormonal_contraception) + ( 1 | short), data = diary %>% filter(included_d== T & abode_flat_share != 2 & relationship_status == 1))

summary(m_tf_2)

``` 

#### relatives seen
```{r}
m_rs = brm(person_is_related_man ~ menstruation_labelled + premenstrual_phase_fab + s(fertile_fab, by = hormonal_contraception) + ( 1 | short / created_diary), data = diary_social %>% filter(included_s == T & person_seen == T & abode_flat_share !=2))

summary(m_rs)

```

#### relatives seen (binomial)
```{r}
m_rsb = brm(person_is_related_man ~ menstruation_labelled + premenstrual_phase_fab + s(fertile_fab, by = hormonal_contraception) + ( 1 | short / created_diary), data = diary_social %>% filter(included_s == T & person_seen == T & abode_flat_share !=2), family = binomial())

summary(m_rsb)

```

```{r message=F,warning=F}
source("0_helpers.R")
library(lme4)
opts_chunk$set(warning = F, message = F)

diary$premenstrual_phase_fab = factor(diary$premenstrual_phase_fab)
diary$hormonal_contraception = factor(diary$hormonal_contraception)
diary_social$premenstrual_phase_fab = factor(diary_social$premenstrual_phase_fab)
diary_social$hormonal_contraception = factor(diary_social$hormonal_contraception)
diary = diary %>% filter(answered_honestly_today == 1, age < 50, menstruation_regular == 1)
```

```{r}
missingness_patterns(s3_daily %>% select(fertile_fab, prc_stirn_b, prc_stirn_b_forward_counted, menstruation_labelled, premenstrual_phase_fab))

model <- lm(person_attractiveness_short_term ~ person_funny + person_financial + person_strength, data= diary_social)
summary(model)
model2 <- lmer(person_attractiveness_short_term ~ person_funny + person_financial + person_strength  + ( 1 | short) + (1 | person), data=diary_social)
summary(model2)
diary_social$hormonal_contraception.x %>% table()
diary_social$person = paste0(diary_social$person, "_", diary_social$short)

diary_social$short_day = paste0(diary_social$short, "_", diary_social$created_date)
model2 <- lmer(person_attractiveness_short_term ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * fertile_fab +  + ( 1 | short/short_day), data= diary_social)
summary(model2)

diary_social$person_male = if_else(diary_social$person_male == 3, NA_integer_, +(diary_social$person_sex == 2))
model2 <- lmer(person_male ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * fertile_fab + ( 1 | short/short_day), data= diary_social)
summary(model2)

diary_social %>% select(person_attractiveness_short_term, menstruation_labelled, premenstrual_phase_fab, hormonal_contraception, fertile_fab) %>% missingness_patterns()

summary(model2)
library(effects)
plot(allEffects(model2))

diary$extra_pair_desire = rowMeans(diary %>% ungroup() %>% select(starts_with("extra_pair_desire_"), -extra_pair_desire_4, -ends_with("R")), na.rm = T)
diary$in_pair_desire = rowMeans(diary %>% ungroup() %>% select(starts_with("in_pair_desire_"), -in_pair_desire_4, -ends_with("R")), na.rm = T)
qplot(diary$extra_pair_desire)
qplot(diary$in_pair_desire)
lmer(extra_pair_desire ~ in_pair_desire + (1|short), data = diary)
diary$attractiveness_stp = scale(diary$attractiveness_stp)
model_ep <- lmer(extra_pair_desire ~ menstruation_labelled + premenstrual_phase_fab + (attractiveness_stp + attractiveness_ltp ) * fertile_fab  * hormonal_contraception + ( 1 | short), data = diary)
summary(model_ep)
model_ep <- lmer(extra_pair_desire ~ menstruation_labelled + premenstrual_phase_fab + fertile_narrow * attractiveness_stp * hormonal_contraception + ( 1 | short), data = diary)
plot_triptych(model_ep, x.var = "fertile_narrow")

library(effects)
plot(allEffects(model_ep))

model_ep <- lmer(extra_pair_desire ~ in_pair_desire + menstruation_labelled + premenstrual_phase_fab + attractiveness_stp * fertile_fab  * hormonal_contraception + ( 1 | short), data = diary)
summary(model_ep)
plot_triptych(model_ep, x.var = "fertile_fab")
model_ep <- lmer(in_pair_desire ~ menstruation_labelled + premenstrual_phase_fab + attractiveness_stp * fertile_fab  * hormonal_contraception + ( 1 | short), data = diary)
summary(model_ep)
plot_triptych(model_ep, x.var = "fertile_fab")

library(brms)
m_ep = brm(extra_pair_desire ~ menstruation_labelled + premenstrual_phase_fab + s(fertile_fab, by = hormonal_contraception) + ( 1 | short), data = diary)

diary_long = diary %>% select(starts_with("extra_pair_desire"), -extra_pair_desire_4, -ends_with("R"), -extra_pair_desire, short, menstruation_labelled, premenstrual_phase_fab, hormonal_contraception, fertile_fab,hetero_relationship) %>% tidyr::gather(variable, value, -short, -menstruation_labelled, -premenstrual_phase_fab, -hormonal_contraception, -fertile_fab, -hetero_relationship)

model3 <- lmer(value ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * fertile_fab + ( 1 + hormonal_contraception * fertile_fab | variable) + ( 1 | short), data = diary_long)
model3 <- lmer(value ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * fertile_fab + hetero_relationship * fertile_fab + ( 1 + hormonal_contraception * fertile_fab | variable) + ( 1 | short), data = diary_long)
summary(model3)
vars = ranef(model3)$variable
vars$label = NA
for (i in 1:nrow(vars)) {
  lab = attributes(s3_daily[, rownames(vars)[i]])$label
  if (length(lab) == 0) {
    lab = paste(attributes(s3_daily[, paste0(rownames(vars)[i], "R")])$label, paste0("[",rownames(vars)[i], "R]"))
  } else {
    lab = paste(lab, paste0("[",rownames(vars)[i], "]"))
  }
  vars$label[i] = lab
}
qplot(label,fertile_fab + fixef(model3)["fertile_fab"], data = vars) + coord_flip()

library(brms)
model3 <- brm(value ~ menstruation_labelled + premenstrual_phase_fab + hetero_relationship * hormonal_contraception * fertile_fab + ( 1 + hetero_relationship * hormonal_contraception * fertile_fab | variable) + ( 1 | short), data = diary_long, family = gaussian())

```

```{r}
model2 <- lmer(extra_pair_desire ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * fertile_fab +  ( 1 | short), data = diary)
summary(model2)
plot(allEffects(model2))

diary$contra = factor(diary$contraception_method_broad)
diary$aware = factor(interaction(diary$contraception_method %contains% "aware", diary$hormonal_contraception))
table(diary$aware)
model3 <- lmer(extra_pair_desire ~ menstruation_labelled + premenstrual_phase_fab + aware * prc_stirn_b +  + ( 1 | short), data= diary %>% filter(aware != "TRUE.TRUE"))
summary(model3)
plot(allEffects(model3, xlevels = 10))
```

```{r}
diary$in_pair_desire = rowMeans(diary %>% ungroup() %>% select(starts_with("in_pair_desire"), -ends_with("R")), na.rm = T)
qplot(diary$in_pair_desire)
model3 <- lmer(in_pair_desire ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary)
summary(model3)
plot(allEffects(model3, xlevels = 10))


model5 <- lmer(high_libido ~ menstruation_labelled + premenstrual_phase_fab + aware * prc_stirn_b +  + ( 1 | short), data= diary %>% filter(aware != "TRUE.TRUE"))
summary(model5)
plot(allEffects(model5, xlevels = 10))


model6 <- lmer(extra_pair_desire ~ high_libido + menstruation_labelled + premenstrual_phase_fab + aware * prc_stirn_b +  + ( 1 | short), data= diary %>% filter(aware != "TRUE.TRUE"))
summary(model6)
plot(allEffects(model6, xlevels = 10))

model7 <- lmer(extra_pair_desire ~ high_libido + in_pair_desire + menstruation_labelled + premenstrual_phase_fab + aware * prc_stirn_b +  + ( 1 | short), data= diary %>% filter(aware != "TRUE.TRUE"))
summary(model7)
plot(allEffects(model7, xlevels = 10))

model7 <- lmer(in_pair_desire ~ extra_pair_desire + menstruation_labelled + premenstrual_phase_fab + aware * prc_stirn_b +  + ( 1 | short), data= diary %>% filter(aware != "TRUE.TRUE"))
summary(model7)
plot(allEffects(model7, xlevels = 10))

items = formr_items("s3_daily") %>% as.data.frame()
diary %>% 
  ungroup() %>%
  select(short, menstruation_labelled, premenstrual_phase_fab, aware, fertile_fab, starts_with("extra_pair_desire_"), starts_with("in_pair_desire_"), high_libido) %>%
  gather(item, value, -short, -menstruation_labelled, -premenstrual_phase_fab, -aware, -fertile_fab) %>%
  left_join(items %>% rename(item = name) %>% select(item, label), by = "item") ->
  mdiary

mdiary$label = factor(mdiary$label)
model7 <- lmer(value ~ menstruation_labelled + premenstrual_phase_fab + aware * label * fertile_fab + ( 1 | short), data= mdiary)
summary(model7)
plot(allEffects(model7, xlevels = 10))
n_distinct(mdiary$label)
plot(effect(term = "aware*label*fertile_fab", model7, xlevels = 33))
```


```{r}
summary(model3 <- lmer(self_esteem ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))
summary(model3 <- lmer(good_mood ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))
summary(model3 <- lmer(relationship_satisfaction_diary ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))
summary(model3 <- lmer(stressed ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))
summary(model3 <- lmer(irritable ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))
summary(model3 <- lmer(loneliness ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))
summary(model3 <- lmer(risk_taking ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))
summary(model3 <- lmer(illness_pain ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))
summary(model3 <- lmer(partner_illness_pain ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))
summary(model3 <- lmer(travel ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))
summary(model3 <- lmer(sleep_amount ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))
summary(model3 <- lmer(sleep_quality ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))

summary(model3 <- lmer(sleep_quality ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))
summary(model3 <- lmer(sleep_duration ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))
summary(model3 <- lmer(time_friends ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))
summary(model3 <- lmer(time_work_uni ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))
summary(model3 <- lmer(time_sports ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))
summary(model3 <- lmer(time_people ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))
summary(model3 <- lmer(time_family ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))
summary(model3 <- lmer(food_amount ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))
summary(model3 <- lmer(meat ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))
summary(model3 <- lmer(alcohol ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))
summary(model3 <- lmer(smoking ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))
summary(model3 <- lmer(grooming_1 ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))
summary(model3 <- lmer(grooming_2 ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))
summary(model3 <- lmer(grooming_time_spent ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))
summary(model3 <- lmer(vanity_1 ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))
summary(model3 <- lmer(vanity_2 ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))
summary(model3 <- lmer(vanity_3 ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))
summary(model3 <- lmer(social_life_active!="was_alone" ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))
summary(model3 <- lmer(night_spent_with_partner ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))

summary(model3 <- lmer(love_showed_to_partner ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))

summary(model3 <- lmer(love_shown_by_partner ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))

summary(model3 <- lmer(mate_retention1 ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))

summary(model3 <- lmer(mate_retention2 ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))

summary(model3 <- lmer(mate_retention3 ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))

summary(model3 <- lmer(conflict_partner ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))

summary(model3 <- lmer(desirability ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))

summary(model3 <- lmer(high_libido ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))

summary(model3 <- lmer(sexual_desire_for_whom == "5" ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))

summary(model3 <- lmer(sexual_initiation_self ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))

summary(model3 <- lmer(sexual_initiation_partner ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))

summary(model3 <- lmer(sexual_desire_wants_desire ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))

summary(model3 <- lmer(sexual_desire_fulfill_sex_needs ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))

summary(model3 <- lmer(sexual_desire_fulfill_partner ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b +  + ( 1 | short), data= diary))

summary(model3 <- lmer(sex_active ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b + ( 1 | short), data= diary))

diary$sex_with_partner = rowSums(cbind(diary$sex_1_withwhom %contains% "mit Partner", diary$sex_2_withwhom %contains% "mit Partner"), na.rm=T) > 1
diary$masturbation = rowSums(cbind(diary$sex_1_withwhom == "alleine", diary$sex_2_withwhom == "mit Partner"), na.rm=T) > 1
summary(model3 <- lmer(sex_with_partner ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b + ( 1 | short), data= diary))
summary(model3 <- lmer(masturbation ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b + ( 1 | short), data= diary))

summary(model3 <- lmer(sex_1_happy ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b + ( 1 | short), data= diary))

summary(model3 <- lmer(sex_1_enjoyed ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b + ( 1 | short), data= diary))

diary = diary %>% rowwise() %>% 
  mutate(
    sex_enjoyed = mean(c(sex_1_enjoyed, sex_2_enjoyed), na.rm = T),
    sex_partner_enjoyed = mean(c(sex_1_partner_enjoyed, sex_2_partner_enjoyed), na.rm = T)
  )
summary(model3 <- lmer(sex_partner_enjoyed ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b + ( 1 | short), data= diary))
summary(model3 <- lmer(sex_enjoyed ~ menstruation_labelled + premenstrual_phase_fab + hormonal_contraception * prc_stirn_b + ( 1 | short), data= diary))

```



```{r}
ggplot(diary %>% filter(FCD_forward_counted<=40), aes(FCD_forward_counted, extra_pair_desire, color = hormonal_contraception)) + geom_smooth(method = "loess")
ggplot(diary %>% filter(RCD > -40), aes(RCD, extra_pair_desire, color = hormonal_contraception)) + geom_smooth(method = "loess")
```


